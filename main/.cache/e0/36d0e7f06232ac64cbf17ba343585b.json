{"id":"ceqd","dependencies":[{"name":"D:\\myWork\\qiankun\\main\\package.json","includedInParent":true,"mtime":1595224822248},{"name":"D:\\myWork\\qiankun\\main\\node_modules\\qiankun\\package.json","includedInParent":true,"mtime":1595217907536},{"name":"lodash/isFunction","loc":{"line":1,"column":24},"parent":"D:\\myWork\\qiankun\\main\\node_modules\\qiankun\\es\\sandbox\\patchers\\historyListener.js","resolved":"D:\\myWork\\qiankun\\main\\node_modules\\lodash\\isFunction.js"},{"name":"lodash/noop","loc":{"line":2,"column":18},"parent":"D:\\myWork\\qiankun\\main\\node_modules\\qiankun\\es\\sandbox\\patchers\\historyListener.js","resolved":"D:\\myWork\\qiankun\\main\\node_modules\\lodash\\noop.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=e;var n=i(require(\"lodash/isFunction\")),t=i(require(\"lodash/noop\"));function i(n){return n&&n.__esModule?n:{default:n}}function e(){var i=function(n){return t.default},e=[],o=[];return window.g_history&&(0,n.default)(window.g_history.listen)&&(i=window.g_history.listen.bind(window.g_history),window.g_history.listen=function(n){e.push(n);var t=i(n);return o.push(t),function(){t(),o.splice(o.indexOf(t),1),e.splice(e.indexOf(n),1)}}),function(){var r=t.default;return e.length&&(r=function(){e.forEach(function(n){return window.g_history.listen(n)})}),o.forEach(function(n){return n()}),window.g_history&&(0,n.default)(window.g_history.listen)&&(window.g_history.listen=i),r}}"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":0}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":13}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":20}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":35}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":43}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":56}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":57}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":64}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":68}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":76}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":84}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":1,"column":0},"generated":{"line":1,"column":86}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":1,"column":0},"generated":{"line":1,"column":90}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":1,"column":0},"generated":{"line":1,"column":92}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":1,"column":0},"generated":{"line":1,"column":94}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":1,"column":0},"generated":{"line":1,"column":102}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":2,"column":0},"generated":{"line":1,"column":124}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":2,"column":0},"generated":{"line":1,"column":126}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":2,"column":0},"generated":{"line":1,"column":128}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":2,"column":0},"generated":{"line":1,"column":136}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":152}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":161}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":163}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":166}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":173}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":176}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":178}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":189}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":191}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":192}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":57,"column":1},"generated":{"line":1,"column":200}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":3,"column":15},"generated":{"line":1,"column":203}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"patch","original":{"line":3,"column":24},"generated":{"line":1,"column":212}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rawHistoryListen","original":{"line":6,"column":6},"generated":{"line":1,"column":216}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rawHistoryListen","original":{"line":6,"column":6},"generated":{"line":1,"column":220}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":6,"column":25},"generated":{"line":1,"column":222}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"_","original":{"line":6,"column":51},"generated":{"line":1,"column":231}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"_noop","original":{"line":7,"column":11},"generated":{"line":1,"column":234}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"_noop","original":{"line":7,"column":11},"generated":{"line":1,"column":241}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":7,"column":4},"generated":{"line":1,"column":243}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":10,"column":6},"generated":{"line":1,"column":252}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":10,"column":25},"generated":{"line":1,"column":254}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyUnListens","original":{"line":11,"column":6},"generated":{"line":1,"column":257}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":11,"column":25},"generated":{"line":1,"column":259}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":28,"column":9},"generated":{"line":1,"column":262}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":13,"column":6},"generated":{"line":1,"column":269}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":13,"column":13},"generated":{"line":1,"column":276}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":13,"column":26},"generated":{"line":1,"column":288}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":13,"column":38},"generated":{"line":1,"column":290}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":13,"column":38},"generated":{"line":1,"column":292}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":13,"column":38},"generated":{"line":1,"column":301}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":13,"column":45},"generated":{"line":1,"column":308}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":13,"column":55},"generated":{"line":1,"column":318}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rawHistoryListen","original":{"line":14,"column":4},"generated":{"line":1,"column":328}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":14,"column":23},"generated":{"line":1,"column":330}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":14,"column":30},"generated":{"line":1,"column":337}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":14,"column":40},"generated":{"line":1,"column":347}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"bind","original":{"line":14,"column":47},"generated":{"line":1,"column":354}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":14,"column":52},"generated":{"line":1,"column":359}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":14,"column":59},"generated":{"line":1,"column":366}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":16,"column":4},"generated":{"line":1,"column":377}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":16,"column":11},"generated":{"line":1,"column":384}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":16,"column":21},"generated":{"line":1,"column":394}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":16,"column":30},"generated":{"line":1,"column":401}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":16,"column":40},"generated":{"line":1,"column":410}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":17,"column":6},"generated":{"line":1,"column":413}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"push","original":{"line":17,"column":23},"generated":{"line":1,"column":415}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":17,"column":28},"generated":{"line":1,"column":420}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":18,"column":10},"generated":{"line":1,"column":423}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":18,"column":10},"generated":{"line":1,"column":427}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rawHistoryListen","original":{"line":18,"column":21},"generated":{"line":1,"column":429}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":18,"column":38},"generated":{"line":1,"column":431}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":20,"column":13},"generated":{"line":1,"column":434}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyUnListens","original":{"line":19,"column":6},"generated":{"line":1,"column":441}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"push","original":{"line":19,"column":23},"generated":{"line":1,"column":443}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":19,"column":28},"generated":{"line":1,"column":448}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":20,"column":13},"generated":{"line":1,"column":451}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":21,"column":8},"generated":{"line":1,"column":462}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyUnListens","original":{"line":22,"column":8},"generated":{"line":1,"column":466}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"splice","original":{"line":22,"column":25},"generated":{"line":1,"column":468}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyUnListens","original":{"line":22,"column":32},"generated":{"line":1,"column":475}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"indexOf","original":{"line":22,"column":49},"generated":{"line":1,"column":477}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":22,"column":57},"generated":{"line":1,"column":485}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":22,"column":68},"generated":{"line":1,"column":488}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":23,"column":8},"generated":{"line":1,"column":491}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"splice","original":{"line":23,"column":25},"generated":{"line":1,"column":493}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":23,"column":32},"generated":{"line":1,"column":500}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"indexOf","original":{"line":23,"column":49},"generated":{"line":1,"column":502}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":23,"column":57},"generated":{"line":1,"column":510}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":23,"column":68},"generated":{"line":1,"column":513}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":28,"column":9},"generated":{"line":1,"column":519}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rebuild","original":{"line":29,"column":8},"generated":{"line":1,"column":530}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rebuild","original":{"line":29,"column":8},"generated":{"line":1,"column":534}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"_noop","original":{"line":29,"column":18},"generated":{"line":1,"column":536}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":29,"column":4},"generated":{"line":1,"column":538}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rebuild","original":{"line":55,"column":11},"generated":{"line":1,"column":546}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":37,"column":8},"generated":{"line":1,"column":553}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"length","original":{"line":37,"column":25},"generated":{"line":1,"column":555}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rebuild","original":{"line":38,"column":6},"generated":{"line":1,"column":564}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":38,"column":16},"generated":{"line":1,"column":566}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyListeners","original":{"line":40,"column":8},"generated":{"line":1,"column":577}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"forEach","original":{"line":40,"column":25},"generated":{"line":1,"column":579}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":40,"column":33},"generated":{"line":1,"column":587}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":40,"column":43},"generated":{"line":1,"column":596}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":41,"column":17},"generated":{"line":1,"column":599}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":41,"column":17},"generated":{"line":1,"column":606}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":41,"column":24},"generated":{"line":1,"column":613}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":41,"column":34},"generated":{"line":1,"column":623}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listener","original":{"line":41,"column":41},"generated":{"line":1,"column":630}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"historyUnListens","original":{"line":47,"column":4},"generated":{"line":1,"column":637}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"forEach","original":{"line":47,"column":21},"generated":{"line":1,"column":639}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":47,"column":29},"generated":{"line":1,"column":647}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":47,"column":39},"generated":{"line":1,"column":656}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":48,"column":13},"generated":{"line":1,"column":659}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"unListen","original":{"line":48,"column":13},"generated":{"line":1,"column":666}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":51,"column":8},"generated":{"line":1,"column":672}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":51,"column":15},"generated":{"line":1,"column":679}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","original":{"line":51,"column":28},"generated":{"line":1,"column":691}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":51,"column":40},"generated":{"line":1,"column":693}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":51,"column":40},"generated":{"line":1,"column":695}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":51,"column":40},"generated":{"line":1,"column":704}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":51,"column":47},"generated":{"line":1,"column":711}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":51,"column":57},"generated":{"line":1,"column":721}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"window","original":{"line":52,"column":6},"generated":{"line":1,"column":731}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"g_history","original":{"line":52,"column":13},"generated":{"line":1,"column":738}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"listen","original":{"line":52,"column":23},"generated":{"line":1,"column":748}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rawHistoryListen","original":{"line":52,"column":32},"generated":{"line":1,"column":755}},{"source":"node_modules/qiankun/es/sandbox/patchers/historyListener.js","name":"rebuild","original":{"line":55,"column":11},"generated":{"line":1,"column":758}}],"sources":{"node_modules/qiankun/es/sandbox/patchers/historyListener.js":"import _isFunction from \"lodash/isFunction\";\nimport _noop from \"lodash/noop\";\nexport default function patch() {\n  // FIXME umi unmount feature request\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  var rawHistoryListen = function rawHistoryListen(_) {\n    return _noop;\n  };\n\n  var historyListeners = [];\n  var historyUnListens = [];\n\n  if (window.g_history && _isFunction(window.g_history.listen)) {\n    rawHistoryListen = window.g_history.listen.bind(window.g_history);\n\n    window.g_history.listen = function (listener) {\n      historyListeners.push(listener);\n      var unListen = rawHistoryListen(listener);\n      historyUnListens.push(unListen);\n      return function () {\n        unListen();\n        historyUnListens.splice(historyUnListens.indexOf(unListen), 1);\n        historyListeners.splice(historyListeners.indexOf(listener), 1);\n      };\n    };\n  }\n\n  return function free() {\n    var rebuild = _noop;\n    /*\n     还存在余量 listener 表明未被卸载，存在两种情况\n     1. 应用在 unmout 时未正确卸载 listener\n     2. listener 是应用 mount 之前绑定的，\n     第二种情况下应用在下次 mount 之前需重新绑定该 listener\n     */\n\n    if (historyListeners.length) {\n      rebuild = function rebuild() {\n        // 必须使用 window.g_history.listen 的方式重新绑定 listener，从而能保证 rebuild 这部分也能被捕获到，否则在应用卸载后无法正确的移除这部分副作用\n        historyListeners.forEach(function (listener) {\n          return window.g_history.listen(listener);\n        });\n      };\n    } // 卸载余下的 listener\n\n\n    historyUnListens.forEach(function (unListen) {\n      return unListen();\n    }); // restore\n\n    if (window.g_history && _isFunction(window.g_history.listen)) {\n      window.g_history.listen = rawHistoryListen;\n    }\n\n    return rebuild;\n  };\n}"},"lineCount":null}},"error":null,"hash":"1f742ecaa69d63a5d50ff94b086d98ed","cacheData":{"env":{}}}